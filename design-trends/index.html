<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="../assets/css/design-trends.css" />
  </head>
  <body>
    <div class="header">
      <h1>‚õ∞ ARAG√ìN ‚õ∞</h1>
      <p>en la provincia de Huesca</p>
    </div>

    <div class="parallax-bg">
      <div>Valle de Benasque</div>
    </div>

    <div class="content">
      <h2>¬øD√≥nde se encuentra?</h2>
      <p>
        Benasque ocupa el valle central de los tres que conforman el Parque
        Natural Posets-Maladeta, un magn√≠fico ejemplo del paisaje pirenaico
        donde las m√°s altas cumbres de todo el Pirineo quedar√°n grabadas para
        siempre en tu retina.
        <br />
        <br />
        El centro neur√°lgico del valle es el pueblo de Benasque. Adem√°s de un
        precioso casco urbano, en √©l encontrar√°s todo tipo de servicios
        tur√≠sticos, desde comercios hasta hoteles y restaurantes.
      </p>

      <!--
      <div class="map-image">
        <img src="../assets/img/img-design-trend-mapa.gif" alt="map" />
      </div>
      -->

      <h2>¬øQu√© hacer?</h2>
      <p>
        Si tienes ganas de nieve, esc√°pate a la estaci√≥n de Aram√≥n Cerler, muy
        pr√≥xima a Benasque. En la de Llanos del Hospital podr√°s practicar esqu√≠
        de fondo, n√≥rdico y de traves√≠a, y en verano, disfrutar de los paseos.
        <br />
        <br />
        Pero sin duda, la mejor manera de conocer este valle paradis√≠aco es
        recorriendo sus m√∫ltiples senderos. Si no est√°s en muy buena forma
        f√≠sica, no te preocupes, ya que existen rutas adaptadas a todo tipo de
        edades y preparaci√≥n. Gracias a ellas podr√°s sentir la naturaleza en
        estado puro. Te recomendamos, especialmente, la famosa excursi√≥n que te
        llevar√° hasta la bella cascada del Forau D‚ÄôAiguallut.
      </p>

      <div class="reflection">
        <strong>¬øQu√© m√°s?</strong>
        En las inmediaciones de Benasque merece la pena darse una vuelta por el
        pueblecito de Anciles y contemplar sus bonitas casas solariegas. Eriste,
        tambi√©n cercano, es un buen punto de partida para acercarse a la mole
        del Posets, segunda cima pirenaica.
      </div>
    </div>

    <div class="normal-bg"></div>

    <div class="content">
      <h2>Comparison: Normal Scrolling</h2>
      <p>
        The section above uses
        <code>background-attachment: scroll</code>
        (the default). Notice how it scrolls with the content instead of staying
        fixed. This is the traditional approach.
      </p>

      <div class="comparison">
        <h3>Key Differences:</h3>
        <ul>
          <li>
            <strong>Parallax (fixed):</strong>
            Background stays in place, content moves over it
          </li>
          <li>
            <strong>Normal (scroll):</strong>
            Background and content move together at the same speed
          </li>
        </ul>
        <p>
          <strong>Tip:</strong>
          Scroll up and down this page multiple times to really feel the
          difference between the purple (parallax) and green (normal) sections!
        </p>
      </div>

      <h2>Mobile Considerations</h2>
      <p>
        On mobile devices,
        <code>background-attachment: fixed</code>
        often doesn't work due to browser limitations. The CSS in this demo
        automatically switches to regular scrolling on smaller screens to ensure
        a good experience for all users.
      </p>

      <div class="reflection">
        <strong>Critical Design Question:</strong>
        Is the parallax effect truly enhancing the user experience, or could it
        be a barrier? Consider users with vestibular disorders who may
        experience discomfort with motion effects. How might we offer
        alternatives or respect the
        <code>prefers-reduced-motion</code>
        media query?
      </div>
    </div>

    <!-- JavaScript-based Parallax with Multiple Layers -->
    <div class="parallax-js-section" id="js-parallax">
      <div
        class="parallax-layer layer-back"
        data-speed="0.2"
        style="transform: translateY(-77.65px)"
      >
        üåå
      </div>
      <div
        class="parallax-layer layer-middle"
        data-speed="0.5"
        style="transform: translateY(-194.125px)"
      >
        ‚òÅÔ∏è
      </div>
      <div
        class="parallax-layer layer-front"
        data-speed="0.8"
        style="transform: translateY(-310.6px)"
      >
        Lluvia de estrellas
      </div>
    </div>

    <div class="content">
      <h2>Technique 2: JavaScript Parallax with transform</h2>
      <p>
        The section above uses
        <strong>
          JavaScript with
          <code>transform: translateY()</code>
        </strong>
        to move elements at different speeds. This offers more control than pure
        CSS.
      </p>

      <div class="code-box">
        <code>
          // Each layer has a data-speed attribute
          <br />
          const layer = document.querySelector('.layer-back');
          <br />
          const speed = layer.dataset.speed; // 0.2 = very slow
          <br />
          <br />
          window.addEventListener('scroll', () =&gt; {
          <br />
          &nbsp;&nbsp;const scrolled = window.pageYOffset;
          <br />
          &nbsp;&nbsp;const yPos = -(scrolled * speed);
          <br />
          &nbsp;&nbsp;layer.style.transform = `translateY(${yPos}px)`;
          <br />
          });
        </code>
      </div>

      <div class="comparison">
        <h3>Advantages of JavaScript Parallax:</h3>
        <ul>
          <li>
            <strong>Precise Control:</strong>
            You can control exactly how fast each layer moves
          </li>
          <li>
            <strong>Multiple Elements:</strong>
            Move any HTML element, not just backgrounds
          </li>
          <li>
            <strong>Works on Mobile:</strong>
            Unlike
            <code>background-attachment: fixed</code>
          </li>
          <li>
            <strong>Complex Animations:</strong>
            Combine with opacity, scale, rotation, etc.
          </li>
        </ul>
        <h3>‚ö†Ô∏è Considerations:</h3>
        <ul>
          <li>Requires JavaScript (fallback if JS is disabled)</li>
          <li>
            Use
            <code>requestAnimationFrame</code>
            for better performance
          </li>
          <li>
            Respect
            <code>prefers-reduced-motion</code>
          </li>
        </ul>
      </div>
    </div>

    <!-- Image-based Parallax Layers -->
    <div class="parallax-image-section" id="image-parallax">
      <div
        class="image-layer image-layer-1"
        data-speed="0.3"
        style="transform: translateY(-115.875px)"
      ></div>
      <div
        class="image-layer image-layer-2"
        data-speed="0.6"
        style="transform: translateY(-231.75px)"
      ></div>
      <div
        class="image-layer image-layer-3"
        data-speed="0.9"
        style="transform: translateY(-347.625px)"
      ></div>
    </div>

    <div class="content">
      <h2>Technique 3: Multi-Layer Images</h2>
      <p>
        The section above combines multiple background images moving at
        different speeds to create a 3D depth effect.
      </p>

      <div class="comparison">
        <h3>üìä Comparison of All 3 Techniques:</h3>
        <table style="width: 100%; border-collapse: collapse; margin-top: 1rem">
          <tbody>
            <tr style="background: #f8f9fa; font-weight: bold">
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                Technique
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                Implementation
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                Mobile Support
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                Complexity
              </td>
            </tr>
            <tr>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                <strong>CSS Fixed</strong>
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                background-attachment: fixed
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                ‚ùå Limited
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                ‚≠ê Very simple
              </td>
            </tr>
            <tr>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                <strong>JS Transform</strong>
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                transform: translateY()
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                ‚úÖ Works
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                ‚≠ê‚≠ê Medium
              </td>
            </tr>
            <tr>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                <strong>Multi-layer</strong>
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                Multiple elements + JS
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                ‚úÖ Works
              </td>
              <td style="padding: 0.75rem; border: 1px solid #dee2e6">
                ‚≠ê‚≠ê‚≠ê Advanced
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="reflection">
        <strong>Final Reflection:</strong>
        Which technique do you prefer? CSS is perfect for simple sites.
        JavaScript offers full control but requires more code. Multi-layer
        creates the most impressive effects but may impact performance.
        <strong>The best choice depends on your specific project.</strong>
      </div>
    </div>

    <script>
      // Check for reduced motion preference
      const prefersReducedMotion = window.matchMedia(
        "(prefers-reduced-motion: reduce)"
      );
      let isReducedMotion = prefersReducedMotion.matches;

      // Handle CSS-based parallax
      function handleMotionPreference() {
        const parallaxElements = document.querySelectorAll(".parallax-bg");

        if (isReducedMotion) {
          // User prefers reduced motion - disable parallax
          parallaxElements.forEach((el) => {
            el.style.backgroundAttachment = "scroll";
          });
          console.log("Parallax disabled: user prefers reduced motion");
        }
      }

      // JavaScript-based Parallax Implementation
      function initParallax() {
        if (isReducedMotion) {
          console.log(
            "JS Parallax disabled: respecting reduced motion preference"
          );
          return;
        }

        const parallaxLayers = document.querySelectorAll(
          ".parallax-layer, .image-layer"
        );
        let ticking = false;

        function updateParallax() {
          parallaxLayers.forEach((layer) => {
            const speed = parseFloat(layer.dataset.speed) || 0.5;
            const section = layer.parentElement;
            const rect = section.getBoundingClientRect();

            // Only animate when section is in viewport
            if (rect.top < window.innerHeight && rect.bottom > 0) {
              // Calculate scroll position relative to section's position
              const sectionTop = section.offsetTop;
              const scrolled = window.pageYOffset;
              const offset = scrolled - sectionTop;
              const yPos = offset * speed * 0.5; // Multiply by 0.5 to reduce movement

              // Use transform for better performance
              layer.style.transform = `translateY(${yPos}px)`;
            }
          });

          ticking = false;
        }

        function requestTick() {
          if (!ticking) {
            requestAnimationFrame(updateParallax);
            ticking = true;
          }
        }

        // Throttle scroll events using requestAnimationFrame
        window.addEventListener("scroll", requestTick, { passive: true });

        // Initial update
        updateParallax();
      }

      // Initialize everything
      handleMotionPreference();
      initParallax();

      // Listen for motion preference changes
      prefersReducedMotion.addEventListener("change", (e) => {
        isReducedMotion = e.matches;
        handleMotionPreference();

        if (isReducedMotion) {
          // Reset all transforms
          document
            .querySelectorAll(".parallax-layer, .image-layer")
            .forEach((layer) => {
              layer.style.transform = "translateY(0)";
            });
        } else {
          initParallax();
        }
      });

      // Log performance info for learning
      console.log("üé¨ Parallax Demo Loaded");
      console.log(
        "üìä Layers detected:",
        document.querySelectorAll(".parallax-layer, .image-layer").length
      );
      console.log(
        "‚ôø Reduced motion:",
        isReducedMotion ? "ENABLED" : "DISABLED"
      );
    </script>
  </body>
</html>
